<!doctype html><html lang=en><head><meta charset=utf-8><meta name=generator content="Hugo 0.145.0"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Sirius"><meta property="og:url" content="https://4bug.cn/post/mini_program/mg_structure/"><link rel=canonical href=https://4bug.cn/post/mini_program/mg_structure/><link rel=alternate type=application/atom+xml href=https://4bug.cn/index.xml title=SIRIUS><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/4bug.cn\/"},"articleSection":"post","name":"小程序开发基础","headline":"小程序开发基础","description":"介绍小程序开发的基础知识\n","inLanguage":"en-US","author":"Sirius","creator":"Sirius","publisher":"Sirius","accountablePerson":"Sirius","copyrightHolder":"Sirius","copyrightYear":"2022","datePublished":"2022-08-11 19:31:26 \u002b0800 \u002b0800","dateModified":"2022-08-11 19:31:26 \u002b0800 \u002b0800","url":"https:\/\/4bug.cn\/post\/mini_program\/mg_structure\/","keywords":["小程序"]}</script><title>小程序开发基础</title>
<meta property="og:title" content="小程序开发基础"><meta property="og:type" content="article"><meta property="og:description" content="介绍小程序开发的基础知识
"><meta name=description content="介绍小程序开发的基础知识
"><meta property="og:locale" content="en-us"><meta property="og:image" content><style>body{font-family:bree serif,sans-serif;-webkit-font-smoothing:antialiased;margin:0 20px}article{max-width:1000px;margin-left:auto;margin-right:auto}a{color:#000;text-decoration:none}a:hover{font-weight:600;text-decoration:underline}.post-ads{margin:50px 0}.markdown-body{font-size:18px;max-width:100%}.markdown-body a{text-decoration:underline;text-decoration-color:#000}.markdown-body blockquote{margin:0;padding:0 1em;color:#57606a;border-left:.25em solid #d0d7de}.markdown-body pre{padding:16px;overflow:auto;border-radius:10px}.markdown-body code{padding:.15em .3em;font-size:85%;background-color:#fae7e7;border-radius:3px}.markdown-body pre>code{padding:0;font-size:85%;background-color:inherit;border:0}.Chinese .markdown-body{line-height:200%}.site-date-catalog{font-size:2rem}.header-title{font-size:2rem;font-weight:700;margin-top:32px;font-family:bungee shade,sans-serif}.header-title a{text-decoration:none}.header-subtitle{color:#666}.header-items{margin:10px 0}.header-item{margin:0 5px}.header-line{width:100%;border-width:2px;border-color:#482936;border-style:solid none none none}.lang-switch{font-weight:600}#posts-list{min-height:600px}.posts-line{font-size:1.2rem;margin:12px 0}.posts-categories{display:flex;flex-direction:row-reverse;font-size:.8rem;margin:auto;text-align:center}.posts-category{padding:3px 0;width:70%;border:#000 2px solid;border-radius:5px}.site-footer{margin-bottom:30px;display:flex;justify-content:center;flex-wrap:wrap;padding:0;border-width:3px;border-style:solid none;border-color:#fff}.site-footer-item{margin-right:12px}.post-header{margin-bottom:50px}.post-title{font-size:2rem;font-weight:600}.post-tags{display:inline;font-weight:600;padding:2px 5px;margin-right:6px;border:#000 2px solid;border-radius:5px}.post-date{font-weight:800;font-style:italic}.post-author{float:right;font-weight:600}.page-content{min-height:60%}.post-content{margin-bottom:50px}.post-content p{hyphens:auto;line-height:1.8;text-justify:ideographic;margin-bottom:1em}.post-content img{max-width:100%;display:block;margin-right:auto;margin-top:6px}.post-content .post-gallery{display:flex;flex-wrap:wrap;gap:6px}.post-content .post-gallery img{margin-right:auto;margin-top:auto;width:calc(50% - 3px)}.related-content{border-width:3px;border-style:solid;border-color:#000;padding:0 10px;margin-bottom:30px;margin-top:30px}.related-content li{margin:5px 0}.taxonomy-term{font-size:3rem}.gallery-img{text-align:center}.gallery-img span{text-align:center}.gallery-img-desc{font-size:.8em;font-weight:800}#disqus_thread{position:relative}#disqus_thread:after{content:"";display:block;height:55px;width:100%;position:absolute;bottom:0;background:#fff}@media screen and (max-width:600px){.header-title,.header-subtitle,.header-items{}.posts-line{font-size:16px}.markdown-body{font-size:16px}.post-title{font-size:2rem}.post-content p{letter-spacing:.05em}.post-content .post-gallery img{width:100%}}@media screen and (max-width:48em){.posts-category{display:none}}</style><style>.container,.container-fluid{margin-right:auto;margin-left:auto}.container-fluid{padding-right:2rem;padding-left:2rem}.row{box-sizing:border-box;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:0;-ms-flex:0 1 auto;flex:initial;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-right:-.5rem;margin-left:-.5rem}.row.reverse{-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}.col.reverse{-webkit-box-orient:vertical;-webkit-box-direction:reverse;-ms-flex-direction:column-reverse;flex-direction:column-reverse}.col-xs,.col-xs-1,.col-xs-10,.col-xs-11,.col-xs-12,.col-xs-2,.col-xs-3,.col-xs-4,.col-xs-5,.col-xs-6,.col-xs-7,.col-xs-8,.col-xs-9,.col-xs-offset-0,.col-xs-offset-1,.col-xs-offset-10,.col-xs-offset-11,.col-xs-offset-12,.col-xs-offset-2,.col-xs-offset-3,.col-xs-offset-4,.col-xs-offset-5,.col-xs-offset-6,.col-xs-offset-7,.col-xs-offset-8,.col-xs-offset-9{box-sizing:border-box;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:none;padding-right:.5rem;padding-left:.5rem}.col-xs{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;-ms-flex-preferred-size:0;flex-basis:0;max-width:100%}.col-xs-1{-ms-flex-preferred-size:8.33333333%;flex-basis:8.33333333%;max-width:8.33333333%}.col-xs-2{-ms-flex-preferred-size:16.66666667%;flex-basis:16.66666667%;max-width:16.66666667%}.col-xs-3{-ms-flex-preferred-size:25%;flex-basis:25%;max-width:25%}.col-xs-4{-ms-flex-preferred-size:33.33333333%;flex-basis:33.33333333%;max-width:33.33333333%}.col-xs-5{-ms-flex-preferred-size:41.66666667%;flex-basis:41.66666667%;max-width:41.66666667%}.col-xs-6{-ms-flex-preferred-size:50%;flex-basis:50%;max-width:50%}.col-xs-7{-ms-flex-preferred-size:58.33333333%;flex-basis:58.33333333%;max-width:58.33333333%}.col-xs-8{-ms-flex-preferred-size:66.66666667%;flex-basis:66.66666667%;max-width:66.66666667%}.col-xs-9{-ms-flex-preferred-size:75%;flex-basis:75%;max-width:75%}.col-xs-10{-ms-flex-preferred-size:83.33333333%;flex-basis:83.33333333%;max-width:83.33333333%}.col-xs-11{-ms-flex-preferred-size:91.66666667%;flex-basis:91.66666667%;max-width:91.66666667%}.col-xs-12{-ms-flex-preferred-size:100%;flex-basis:100%;max-width:100%}.col-xs-offset-0{margin-left:0}.col-xs-offset-1{margin-left:8.33333333%}.col-xs-offset-2{margin-left:16.66666667%}.col-xs-offset-3{margin-left:25%}.col-xs-offset-4{margin-left:33.33333333%}.col-xs-offset-5{margin-left:41.66666667%}.col-xs-offset-6{margin-left:50%}.col-xs-offset-7{margin-left:58.33333333%}.col-xs-offset-8{margin-left:66.66666667%}.col-xs-offset-9{margin-left:75%}.col-xs-offset-10{margin-left:83.33333333%}.col-xs-offset-11{margin-left:91.66666667%}.start-xs{-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;text-align:start}.center-xs{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;text-align:center}.end-xs{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;text-align:end}.top-xs{-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}.middle-xs{-webkit-box-align:center;-ms-flex-align:center;align-items:center}.bottom-xs{-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end}.around-xs{-ms-flex-pack:distribute;justify-content:space-around}.between-xs{-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.first-xs{-webkit-box-ordinal-group:0;-ms-flex-order:-1;order:-1}.last-xs{-webkit-box-ordinal-group:2;-ms-flex-order:1;order:1}@media only screen and (min-width:48em){.container{width:49rem}.col-sm,.col-sm-1,.col-sm-10,.col-sm-11,.col-sm-12,.col-sm-2,.col-sm-3,.col-sm-4,.col-sm-5,.col-sm-6,.col-sm-7,.col-sm-8,.col-sm-9,.col-sm-offset-0,.col-sm-offset-1,.col-sm-offset-10,.col-sm-offset-11,.col-sm-offset-12,.col-sm-offset-2,.col-sm-offset-3,.col-sm-offset-4,.col-sm-offset-5,.col-sm-offset-6,.col-sm-offset-7,.col-sm-offset-8,.col-sm-offset-9{box-sizing:border-box;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:none;padding-right:.5rem;padding-left:.5rem}.col-sm{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;-ms-flex-preferred-size:0;flex-basis:0;max-width:100%}.col-sm-1{-ms-flex-preferred-size:8.33333333%;flex-basis:8.33333333%;max-width:8.33333333%}.col-sm-2{-ms-flex-preferred-size:16.66666667%;flex-basis:16.66666667%;max-width:16.66666667%}.col-sm-3{-ms-flex-preferred-size:25%;flex-basis:25%;max-width:25%}.col-sm-4{-ms-flex-preferred-size:33.33333333%;flex-basis:33.33333333%;max-width:33.33333333%}.col-sm-5{-ms-flex-preferred-size:41.66666667%;flex-basis:41.66666667%;max-width:41.66666667%}.col-sm-6{-ms-flex-preferred-size:50%;flex-basis:50%;max-width:50%}.col-sm-7{-ms-flex-preferred-size:58.33333333%;flex-basis:58.33333333%;max-width:58.33333333%}.col-sm-8{-ms-flex-preferred-size:66.66666667%;flex-basis:66.66666667%;max-width:66.66666667%}.col-sm-9{-ms-flex-preferred-size:75%;flex-basis:75%;max-width:75%}.col-sm-10{-ms-flex-preferred-size:83.33333333%;flex-basis:83.33333333%;max-width:83.33333333%}.col-sm-11{-ms-flex-preferred-size:91.66666667%;flex-basis:91.66666667%;max-width:91.66666667%}.col-sm-12{-ms-flex-preferred-size:100%;flex-basis:100%;max-width:100%}.col-sm-offset-0{margin-left:0}.col-sm-offset-1{margin-left:8.33333333%}.col-sm-offset-2{margin-left:16.66666667%}.col-sm-offset-3{margin-left:25%}.col-sm-offset-4{margin-left:33.33333333%}.col-sm-offset-5{margin-left:41.66666667%}.col-sm-offset-6{margin-left:50%}.col-sm-offset-7{margin-left:58.33333333%}.col-sm-offset-8{margin-left:66.66666667%}.col-sm-offset-9{margin-left:75%}.col-sm-offset-10{margin-left:83.33333333%}.col-sm-offset-11{margin-left:91.66666667%}.start-sm{-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;text-align:start}.center-sm{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;text-align:center}.end-sm{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;text-align:end}.top-sm{-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}.middle-sm{-webkit-box-align:center;-ms-flex-align:center;align-items:center}.bottom-sm{-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end}.around-sm{-ms-flex-pack:distribute;justify-content:space-around}.between-sm{-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.first-sm{-webkit-box-ordinal-group:0;-ms-flex-order:-1;order:-1}.last-sm{-webkit-box-ordinal-group:2;-ms-flex-order:1;order:1}}@media only screen and (min-width:64em){.container{width:65rem}.col-md,.col-md-1,.col-md-10,.col-md-11,.col-md-12,.col-md-2,.col-md-3,.col-md-4,.col-md-5,.col-md-6,.col-md-7,.col-md-8,.col-md-9,.col-md-offset-0,.col-md-offset-1,.col-md-offset-10,.col-md-offset-11,.col-md-offset-12,.col-md-offset-2,.col-md-offset-3,.col-md-offset-4,.col-md-offset-5,.col-md-offset-6,.col-md-offset-7,.col-md-offset-8,.col-md-offset-9{box-sizing:border-box;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:none;padding-right:.5rem;padding-left:.5rem}.col-md{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;-ms-flex-preferred-size:0;flex-basis:0;max-width:100%}.col-md-1{-ms-flex-preferred-size:8.33333333%;flex-basis:8.33333333%;max-width:8.33333333%}.col-md-2{-ms-flex-preferred-size:16.66666667%;flex-basis:16.66666667%;max-width:16.66666667%}.col-md-3{-ms-flex-preferred-size:25%;flex-basis:25%;max-width:25%}.col-md-4{-ms-flex-preferred-size:33.33333333%;flex-basis:33.33333333%;max-width:33.33333333%}.col-md-5{-ms-flex-preferred-size:41.66666667%;flex-basis:41.66666667%;max-width:41.66666667%}.col-md-6{-ms-flex-preferred-size:50%;flex-basis:50%;max-width:50%}.col-md-7{-ms-flex-preferred-size:58.33333333%;flex-basis:58.33333333%;max-width:58.33333333%}.col-md-8{-ms-flex-preferred-size:66.66666667%;flex-basis:66.66666667%;max-width:66.66666667%}.col-md-9{-ms-flex-preferred-size:75%;flex-basis:75%;max-width:75%}.col-md-10{-ms-flex-preferred-size:83.33333333%;flex-basis:83.33333333%;max-width:83.33333333%}.col-md-11{-ms-flex-preferred-size:91.66666667%;flex-basis:91.66666667%;max-width:91.66666667%}.col-md-12{-ms-flex-preferred-size:100%;flex-basis:100%;max-width:100%}.col-md-offset-0{margin-left:0}.col-md-offset-1{margin-left:8.33333333%}.col-md-offset-2{margin-left:16.66666667%}.col-md-offset-3{margin-left:25%}.col-md-offset-4{margin-left:33.33333333%}.col-md-offset-5{margin-left:41.66666667%}.col-md-offset-6{margin-left:50%}.col-md-offset-7{margin-left:58.33333333%}.col-md-offset-8{margin-left:66.66666667%}.col-md-offset-9{margin-left:75%}.col-md-offset-10{margin-left:83.33333333%}.col-md-offset-11{margin-left:91.66666667%}.start-md{-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;text-align:start}.center-md{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;text-align:center}.end-md{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;text-align:end}.top-md{-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}.middle-md{-webkit-box-align:center;-ms-flex-align:center;align-items:center}.bottom-md{-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end}.around-md{-ms-flex-pack:distribute;justify-content:space-around}.between-md{-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.first-md{-webkit-box-ordinal-group:0;-ms-flex-order:-1;order:-1}.last-md{-webkit-box-ordinal-group:2;-ms-flex-order:1;order:1}}@media only screen and (min-width:75em){.container{width:76rem}.col-lg,.col-lg-1,.col-lg-10,.col-lg-11,.col-lg-12,.col-lg-2,.col-lg-3,.col-lg-4,.col-lg-5,.col-lg-6,.col-lg-7,.col-lg-8,.col-lg-9,.col-lg-offset-0,.col-lg-offset-1,.col-lg-offset-10,.col-lg-offset-11,.col-lg-offset-12,.col-lg-offset-2,.col-lg-offset-3,.col-lg-offset-4,.col-lg-offset-5,.col-lg-offset-6,.col-lg-offset-7,.col-lg-offset-8,.col-lg-offset-9{box-sizing:border-box;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:none;padding-right:.5rem;padding-left:.5rem}.col-lg{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;-ms-flex-preferred-size:0;flex-basis:0;max-width:100%}.col-lg-1{-ms-flex-preferred-size:8.33333333%;flex-basis:8.33333333%;max-width:8.33333333%}.col-lg-2{-ms-flex-preferred-size:16.66666667%;flex-basis:16.66666667%;max-width:16.66666667%}.col-lg-3{-ms-flex-preferred-size:25%;flex-basis:25%;max-width:25%}.col-lg-4{-ms-flex-preferred-size:33.33333333%;flex-basis:33.33333333%;max-width:33.33333333%}.col-lg-5{-ms-flex-preferred-size:41.66666667%;flex-basis:41.66666667%;max-width:41.66666667%}.col-lg-6{-ms-flex-preferred-size:50%;flex-basis:50%;max-width:50%}.col-lg-7{-ms-flex-preferred-size:58.33333333%;flex-basis:58.33333333%;max-width:58.33333333%}.col-lg-8{-ms-flex-preferred-size:66.66666667%;flex-basis:66.66666667%;max-width:66.66666667%}.col-lg-9{-ms-flex-preferred-size:75%;flex-basis:75%;max-width:75%}.col-lg-10{-ms-flex-preferred-size:83.33333333%;flex-basis:83.33333333%;max-width:83.33333333%}.col-lg-11{-ms-flex-preferred-size:91.66666667%;flex-basis:91.66666667%;max-width:91.66666667%}.col-lg-12{-ms-flex-preferred-size:100%;flex-basis:100%;max-width:100%}.col-lg-offset-0{margin-left:0}.col-lg-offset-1{margin-left:8.33333333%}.col-lg-offset-2{margin-left:16.66666667%}.col-lg-offset-3{margin-left:25%}.col-lg-offset-4{margin-left:33.33333333%}.col-lg-offset-5{margin-left:41.66666667%}.col-lg-offset-6{margin-left:50%}.col-lg-offset-7{margin-left:58.33333333%}.col-lg-offset-8{margin-left:66.66666667%}.col-lg-offset-9{margin-left:75%}.col-lg-offset-10{margin-left:83.33333333%}.col-lg-offset-11{margin-left:91.66666667%}.start-lg{-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;text-align:start}.center-lg{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;text-align:center}.end-lg{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;text-align:end}.top-lg{-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}.middle-lg{-webkit-box-align:center;-ms-flex-align:center;align-items:center}.bottom-lg{-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end}.around-lg{-ms-flex-pack:distribute;justify-content:space-around}.between-lg{-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.first-lg{-webkit-box-ordinal-group:0;-ms-flex-order:-1;order:-1}.last-lg{-webkit-box-ordinal-group:2;-ms-flex-order:1;order:1}}</style><link href=/index.xml rel=alternate type=application/rss+xml title=SIRIUS><link rel=preconnect href=https://fonts.gstatic.com><link href="https://fonts.googleapis.com/css?family=Bree+Serif|Bungee+Shade" rel=stylesheet><script async src="https://www.googletagmanager.com/gtag/js?id=G-2744VHZR5Y"></script></head><body><article class=post id=article><div class=row><div class=col-xs-12><div class=site-header><header><div class=header-title><a href=/>Sirius</a></div><div class=header-subtitle>something meaningless</div></header><div class="row end-md header-items"><div class=header-item><a href=/about>About</a></div></div><div class=row></div><div class=header-line></div></div><header class=post-header><h1 class=post-title>小程序开发基础</h1><div class="row post-desc"><div class=col-xs-6><time class=post-date datetime="2022-08-11 19:31:26 +0800">11 Aug 2022</time></div><div class=col-xs-6><div class=post-author><a target=_blank href=https://4bug.cn>@Sirius</a></div></div></div></header><div class="post-content markdown-body"><p>介绍小程序开发的基础知识</p><h3 id=小程序的生命周期>小程序的生命周期</h3><p>小程序的生命周期分组件生命周期和页面生命周期
<img src=https://img.5bug.cn/20220811180038.png alt></p><h3 id=小程序的架构>小程序的架构</h3><ol><li>使用纯客户端的原生技术来编码渲染，就意味着小程序要与微信本身的代码一起编译打包和发布版本，那么小程序的开发节奏就无法做到像 Web 那样快；</li><li>如果我们使用纯 Web 的技术来做页面渲染，那么页面的渲染和页面逻辑执行的脚本就会处于同一个线程，容易导致业务逻辑和 UI 渲染互相抢占资源，从而在一些较为复杂的页面上出现一些性能问题；</li><li>如果采用介于客户端原生技术与 Web 技术之间的渲染方式，小程序使用混合模式开发，就可以像 Web 一样支持在线快速更新，又可以跨平台，同时比 Web 更接近原生体验，保持原生 App 良好的用户交互体验优势。</li></ol><p><img src=https://img.5bug.cn/20220811180236.png alt=小程序的架构></p><h4 id=逻辑层>逻辑层</h4><p>逻辑层主要进行数据请求和业务逻辑处理，通过 <strong>JS 引擎</strong>提供的沙箱环境来执行JS。与浏览器 Web 开发相比，逻辑层开发无法直接操作 DOM 和 BOM，无法使用一些浏览器暴露的接口（如跳转页面、动态执行脚本），从而提高了管控力和安全性。逻辑层主要负责将数据进行处理后再发送给渲染层，同时接收渲染层的事件反馈，对数据进行反向操作。对微信小程序来说，逻辑层就是所有 js 文件的集合。</p><h4 id=渲染层>渲染层</h4><p>渲染层主要在 <strong>WebView 线程</strong>中执行界面渲染相关的任务，对于微信小程序而言，渲染层就是所有 WXML（WeiXin Mark Language）文件与 WXSS（WeiXin Style Sheet）文件的集合。通过 Virtual DOM 减少渲染开销，提高局部更新数据和重渲染的效率，让页面更流畅。</p><h4 id=系统层>系统层</h4><ol><li>通过 JSBridge 构建 JS 和 Native 之间的通信，以便上层间接调用客户端的原生底层接口；</li><li>通过 JSBridge 构建 JS 和 Native 之间的通信，以便上层间接调用客户端的原生底层接口；</li><li>通过 JSBridge 构建 JS 和 Native 之间的通信，以便上层间接调用客户端的原生底层接口；</li></ol><p>在双线程模型下，把界面渲染和逻辑处理分离、并行处理，可以加快渲染速度，避免单线程模型下因为 JS 运算时间过长导致的 UI 卡顿问题。并且，采用数据驱动的方式，开发者将无法直接操作 DOM，可以加强管控和安全。但是，双线程模型也意味着逻辑层与渲染层之间的通信、各层与客户端的原生交互会有一定的延时。</p><h3 id=小程序的开发框架>小程序的开发框架</h3><p>小程序开发使用的框架称为 MINA 框架，包含上面提到的逻辑渲染系统三层</p><h3 id=小程序的逻辑层开发>小程序的逻辑层开发</h3><h4 id=文件结构>文件结构</h4><p><img src=https://img.5bug.cn/20220811180913.png alt></p><h5 id=主体文件>主体文件</h5><p>小程序的主体文件是全局文件，必须放在项目的根目录，它的配置会影响整个小程序项目。小程序的主体文件主要由 3 个文件组成
<img src=https://img.5bug.cn/20220811181031.png alt></p><h5 id=页面文件>页面文件</h5><p><img src=https://img.5bug.cn/20220811181052.png alt></p><ul><li>index.wxml 作为页面结构描述，负责页面渲染；</li><li>index.json 作为页面配置，可以覆盖上述主体文件中 app.json 的配置；</li><li>index.wxss 是针对 index.wxml 的样式补充；</li><li>index.js 用来作为业务逻辑处理
在项目目录中，js、app.json、wxml、wxss 文件会经过编译，因此上传之后无法直接访问，其中 wxml 和 wxss 文件仅针对在 app.json 中配置了的页面。除此之外，只有后缀名在白名单内的文件可以被上传，不在白名单内的文件可以在开发工具内访问，但无法被上传</li></ul><h4 id=小程序的配置>小程序的配置</h4><p>对于初学者来说，只需要记住 3 个核心配置项的内容即可：<strong>页面路由配置项、窗口表现配置项和底部标签导航配置项</strong>。</p><h5 id=页面路由配置项>页面路由配置项</h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>    <span style=color:#e6db74>&#34;pages&#34;</span><span style=color:#960050;background-color:#1e0010>:</span> [
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;pages/index/index&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;pages/demo/demo&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;pages/center/center&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;pages/modifyaddr/modifyaddr&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;pages/address/address&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;pages/cart/cart&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;pages/productlist/productlist&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;pages/detail/detail&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;pages/noticedetail/noticedetail&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;pages/class/class&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;pages/help/help&#34;</span>
</span></span><span style=display:flex><span>    ]
</span></span></code></pre></div><blockquote><p>实际执行时是按照字母序（文件排序方式）加载的。当然，默认的第一个页面会设定为小程序的首页。</p></blockquote><p>小技巧：我们如果要新创建一个页面访问路径，只需要在配置文件中加上这个页面路径的地址，小程序开发工具就会自动生成对应的文件夹及文件夹下对应的 js、json、wxml、wxss 基本文件。</p><h5 id=窗口表现配置项>窗口表现配置项</h5><h6 id=窗口展示配置包括>窗口展示配置包括:</h6><ul><li>导航栏背景颜色配置（navigationBarBackgroundColor）</li><li>导航栏标题颜色配置（navigationBarTextStyle）</li><li>导航栏标题文字内容配置（navigationBarTitleText）</li><li>导航栏样式配置（navigationStyle）</li><li>等；</li></ul><h6 id=窗口效果配置>窗口效果配置</h6><p>主要包含:</p><ul><li>是否开启全局的下拉刷新（enablePullDownRefresh）</li><li>屏幕旋转方向设置（pageOrientation）</li><li>等
该配置项的内容基本是可选的。对大部分开发者来说，只需要完成配置<strong>navigationBarTitleText</strong> 即可，这个配置标注了小程序默认的导航栏标题文字内容。</li></ul><h5 id=底部标签导航配置项>底部标签导航配置项</h5><h6 id=tabbar属性><em>tabBar</em>属性</h6><p><strong>color</strong> 属性是指 tab 上的文字默认颜色，仅支持十六进制颜色；selectedColor 属性是指 tab 上的文字选中时的颜色；backgroundColor 指出了 tab 的背景色；list 属性是 tab 的列表数组，它只能配置最少 2 个、最多 5 个 tab
<strong>list</strong> 配置项是这个配置中的核心，它是一个数组，tab 按数组的顺序排序，每个项都是一个对象，每个对象包含 pagePath、text 两个必填项和 iconPath、selectedIconPath 两个选填项。后面两个配置项是 tabBar 支持配置图片icon。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>    <span style=color:#e6db74>&#34;tabBar&#34;</span><span style=color:#960050;background-color:#1e0010>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;color&#34;</span>: <span style=color:#e6db74>&#34;#7c7c7c&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;selectedColor&#34;</span>: <span style=color:#e6db74>&#34;#f7545f&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;borderStyle&#34;</span>: <span style=color:#e6db74>&#34;white&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;backgroundColor&#34;</span>: <span style=color:#e6db74>&#34;#ffffff&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;list&#34;</span>: [
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;pagePath&#34;</span>: <span style=color:#e6db74>&#34;pages/index/index&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;iconPath&#34;</span>: <span style=color:#e6db74>&#34;images/tabbar/home.png&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;selectedIconPath&#34;</span>: <span style=color:#e6db74>&#34;images/tabbar/curhome.png&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;text&#34;</span>: <span style=color:#e6db74>&#34;首页&#34;</span>
</span></span><span style=display:flex><span>            },
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;pagePath&#34;</span>: <span style=color:#e6db74>&#34;pages/class/class&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;iconPath&#34;</span>: <span style=color:#e6db74>&#34;images/tabbar/class.png&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;selectedIconPath&#34;</span>: <span style=color:#e6db74>&#34;images/tabbar/curclass.png&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;text&#34;</span>: <span style=color:#e6db74>&#34;分类&#34;</span>
</span></span><span style=display:flex><span>            },
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;pagePath&#34;</span>: <span style=color:#e6db74>&#34;pages/cart/cart&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;iconPath&#34;</span>: <span style=color:#e6db74>&#34;images/tabbar/cart.png&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;selectedIconPath&#34;</span>: <span style=color:#e6db74>&#34;images/tabbar/curcart.png&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;text&#34;</span>: <span style=color:#e6db74>&#34;购物车&#34;</span>
</span></span><span style=display:flex><span>            },
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;pagePath&#34;</span>: <span style=color:#e6db74>&#34;pages/center/center&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;iconPath&#34;</span>: <span style=color:#e6db74>&#34;images/tabbar/person.png&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;selectedIconPath&#34;</span>: <span style=color:#e6db74>&#34;images/tabbar/curperson.png&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;text&#34;</span>: <span style=color:#e6db74>&#34;个人&#34;</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        ]
</span></span><span style=display:flex><span>    }<span style=color:#960050;background-color:#1e0010>,</span>
</span></span></code></pre></div><h5 id=页面配置文件解析>页面配置文件解析</h5><p>除了全局配置文件外，每一个小程序页面也可以使用同名 json 文件来对本页面的窗口表现进行配置，页面配置文件只能设置全局配置文件中 <strong>window</strong> 相关的配置项，也就是可以指定各个页面的窗口表现，页面配置文件中的配置项会覆盖 app.json 的 window 中相同的配置项。</p><h4 id=小程序的场景值>小程序的场景值</h4><p>场景值用来描述用户进入小程序的路径，可以帮助开发者了解用户是如何访问我们的小程序的</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>App</span>({
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>onLaunch</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>options</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;[onLaunch] 场景值:&#34;</span>, <span style=color:#a6e22e>options</span>.<span style=color:#a6e22e>scene</span>)
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>onShow</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>options</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;[onShow] 场景值:&#34;</span>, <span style=color:#a6e22e>options</span>.<span style=color:#a6e22e>scene</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>})
</span></span></code></pre></div><h4 id=页面注册与生命周期>页面注册与生命周期</h4><p>微信小程序是通过 <strong>app.js</strong> 来管理生命周期的</p><h5 id=应用生命周期的注册>应用生命周期的注册</h5><p>一般使用 App(Object object) 来注册小程序，从而管理自己的生命周期。每个小程序都需要在 app.js 中调用 App() 方法注册小程序实例，绑定生命周期回调函数、错误监听和页面不存在监听函数等。在 app.js 中，这个函数接收一个Object 参数，其中指定了小程序的生命周期回调
<strong>App()</strong> 必须在 <strong>app.js</strong> 中注册。在一个小程序中，App() 方法有且仅有一个，不能注册多个，否则可能会出现无法预期的后果
<img src=https://img.5bug.cn/20220811184009.png alt>
app.js 除了定义生命周期外，还可定义全局变量,通过 **getApp()**获取app实例</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// other.js
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>appInstance</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>getApp</span>()
</span></span><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>appInstance</span>.<span style=color:#a6e22e>globalData</span>)
</span></span></code></pre></div><p>注意：</p><ol><li>App() 必须在 app.js 中注册，不可以在 App() 函数内或在定义 App() 函数前调用 getApp() 方法；</li><li>通过 getApp() 方法获取实例后，不可以私自调用生命周期函数</li></ol><h5 id=页面生命周期的注册>页面生命周期的注册</h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// pages/index/hello.js
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Page</span>({
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>* 页面的初始数据
</span></span></span><span style=display:flex><span><span style=color:#75715e>*/</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>data</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>},
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>* 生命周期函数--监听页面加载
</span></span></span><span style=display:flex><span><span style=color:#75715e>*/</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>onLoad</span>(<span style=color:#a6e22e>options</span>) {
</span></span><span style=display:flex><span>},
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>* 生命周期函数--监听页面初次渲染完成
</span></span></span><span style=display:flex><span><span style=color:#75715e>*/</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>onReady</span>() {
</span></span><span style=display:flex><span>},
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>* 生命周期函数--监听页面显示
</span></span></span><span style=display:flex><span><span style=color:#75715e>*/</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>onShow</span>() {
</span></span><span style=display:flex><span>},
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>* 生命周期函数--监听页面隐藏
</span></span></span><span style=display:flex><span><span style=color:#75715e>*/</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>onHide</span>() {
</span></span><span style=display:flex><span>},
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>* 生命周期函数--监听页面卸载
</span></span></span><span style=display:flex><span><span style=color:#75715e>*/</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>onUnload</span>() {
</span></span><span style=display:flex><span>},
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>* 页面相关事件处理函数--监听用户下拉动作
</span></span></span><span style=display:flex><span><span style=color:#75715e>*/</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>onPullDownRefresh</span>() {
</span></span><span style=display:flex><span>},
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>* 页面上拉触底事件的处理函数
</span></span></span><span style=display:flex><span><span style=color:#75715e>*/</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>onReachBottom</span>() {
</span></span><span style=display:flex><span>},
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>* 用户点击右上角分享
</span></span></span><span style=display:flex><span><span style=color:#75715e>*/</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>onShareAppMessage</span>() {
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>})
</span></span></code></pre></div><p>Page 这个 prototype 中还注册了 data 属性、route 属性和 setData()方法。
Page.prototype.route() 方法可以获取当前所处的页面，也可以使用 getCurrentPages() 函数获取当前页面栈，该函数用于获取当前页面栈的实例，并以数组形式按栈的顺序给出，第一个元素为首页，最后一个元素为当前页面。而 Page.prototype.data 就是当前页面的数据内容。
小程序的每个页面都有一个 data 对象来存放当前页面的数据，可以使用Page.prototype.setData() 来修改</p><h4 id=渲染页面>渲染页面</h4><ol><li>如何渲染页面<ol><li>你在代码中写的初始化 data 数据将传递给渲染层进行第一次渲染。data 会以JSON 的形式由逻辑层传至渲染层，所以数据必须可以转成 JSON 的格式：字符串、数字、布尔值、对象、数组。</li></ol></li><li></li></ol></div><div class="row middle-xs"><div class=col-xs-12><div class=post-tags><a href=/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/>小程序</a></div></div></div><div class=row><div class=col-xs-12></div></div><div class=related-content><h3>Related Posts</h3><ul><li><a href=/post/article/note_jinyu/>禁欲|如何带给我们真正的自由</a></li><li><a href=/post/cs/login_auth/>登录和授权</a></li><li><a href=/post/cs/code_reference/>编码、加密、hash、序列化、字符集</a></li></ul></div><div style=height:0></div><div class=site-footer><div class=site-footer-item><a href="https://www.upyun.com/?utm_source=lianmeng&utm_medium=referral"><img src="https://img.shields.io/badge/CDN-%E5%8F%88%E6%8B%8D%E4%BA%91-000000?style=flat-square" title=本网站由又拍云提供CDN加速和云存储服务></a></div><div class=site-footer-item><a href=https://gohugo.io><img src="https://img.shields.io/badge/Blog-HUGO-%23000000?style=flat-square" title="blog by hugo"></a></div><div class=site-footer-item><a href=https://github.com/joway/hugo-theme-yinyang><img src="https://img.shields.io/badge/Theme-Yingyang-%23000000?style=flat-square" title="theme by yinyang"></a></div><div class=site-footer-item><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/><img src="https://img.shields.io/badge/CC-BY--NC--SA%204.0-%23000?style=flat-square" title="Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0)"></a></div></div></div></div></article><script></script></body></html>